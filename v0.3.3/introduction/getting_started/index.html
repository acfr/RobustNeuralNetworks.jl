<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Getting Started · RobustNeuralNetworks.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="RobustNeuralNetworks.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">RobustNeuralNetworks.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Introduction</span><ul><li class="is-active"><a class="tocitem" href>Getting Started</a><ul class="internal"><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Basic-Usage"><span>Basic Usage</span></a></li><li><a class="tocitem" href="#Walkthrough"><span>Walkthrough</span></a></li></ul></li><li><a class="tocitem" href="../package_overview/">Package Overview</a></li><li><a class="tocitem" href="../developing/">Contributing to the Package</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/lbdn_curvefit/">Fitting a Curve</a></li><li><a class="tocitem" href="../../examples/lbdn_mnist/">Image Classification</a></li><li><a class="tocitem" href="../../examples/rl/">Reinforcement Learning</a></li><li><a class="tocitem" href="../../examples/box_obsv/">Observer Design</a></li><li><a class="tocitem" href="../../examples/echo_ren/">(Convex) Nonlinear Control</a></li></ul></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../../lib/models/">Model Wrappers</a></li><li><a class="tocitem" href="../../lib/model_params/">Model Parameterisations</a></li><li><a class="tocitem" href="../../lib/functions/">Functions</a></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Introduction</a></li><li class="is-active"><a href>Getting Started</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Getting Started</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/acfr/RobustNeuralNetworks.jl/blob/main/docs/src/introduction/getting_started.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Getting-Started"><a class="docs-heading-anchor" href="#Getting-Started">Getting Started</a><a id="Getting-Started-1"></a><a class="docs-heading-anchor-permalink" href="#Getting-Started" title="Permalink"></a></h1><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><p><code>RobustNeuralNetworks.jl</code> is written in Julia and can be installed with the package manager. To add the package, type the following into the REPL.</p><pre><code class="nohighlight hljs">] add RobustNeuralNetworks</code></pre><h2 id="Basic-Usage"><a class="docs-heading-anchor" href="#Basic-Usage">Basic Usage</a><a id="Basic-Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-Usage" title="Permalink"></a></h2><p>You should now be able to construct robust neural network models. The following example constructs a Lipschitz-bounded REN and evalutates it given a batch of random initial states and inputs.</p><pre><code class="language-julia hljs">using Random
using RobustNeuralNetworks

# Setup
rng = Xoshiro(42)
batches = 10
nu, nx, nv, ny = 4, 10, 20, 1
γ = 1

# Construct a REN
lipschitz_ren_ps = LipschitzRENParams{Float64}(nu, nx, nv, ny, γ; rng)
ren = REN(lipschitz_ren_ps)

# Some random inputs
x0 = init_states(ren, batches; rng)
u0 = randn(rng, ren.nu, batches)

# Evaluate the REN over one timestep
x1, y1 = ren(x0, u0)

# Print results for testing
println(round.(y1; digits=2))

# output

[1.06 1.13 0.95 0.93 1.03 0.78 0.75 1.42 0.89 1.44]</code></pre><p>For detailed examples of training models from <code>RobustNeuralNetworks.jl</code>, we recommend starting with <a href="../../examples/lbdn_curvefit/#Fitting-a-Curve-with-LBDN">Fitting a Curve with LBDN</a> and working through the subsequent examples.</p><h2 id="Walkthrough"><a class="docs-heading-anchor" href="#Walkthrough">Walkthrough</a><a id="Walkthrough-1"></a><a class="docs-heading-anchor-permalink" href="#Walkthrough" title="Permalink"></a></h2><p>Let&#39;s step through the example above. It constructs and evaluates a Lipschitz-bounded REN. We start by importing packages and setting a random seed.</p><pre><code class="language-julia hljs">using Random
using RobustNeuralNetworks</code></pre><p>Let&#39;s set a random seed and define our batch size and some hyperparameters. For this example, we&#39;ll build a Lipschitz-bounded REN with 4 inputs, 1 output, 10 states, 20 neurons, and a Lipschitz bound of <code>γ = 1</code>.</p><pre><code class="language-julia hljs">rng = Xoshiro(42)
batches = 10

γ = 1
nu, nx, nv, ny = 4, 10, 20, 1</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(4, 10, 20, 1)</code></pre><p>Now we can construct the REN parameters. The variable <code>lipschitz_ren_ps</code> contains all the parameters required to build a Lipschitz-bounded REN. Note that we separate the model parameterisation and its &quot;explicit&quot; (callable) form in <code>RobustNeuralNetworks.jl</code>. See the <a href="../package_overview/#Package-Overview">Package Overview</a> for more details.</p><pre><code class="language-julia hljs">lipschitz_ren_ps = LipschitzRENParams{Float64}(nu, nx, nv, ny, γ; rng)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">LipschitzRENParams{Float64}(NNlib.relu, 4, 10, 20, 1, DirectRENParams{Float64}([-0.06712865084409714 0.05348382890224457 … -0.10525631904602051 0.07951543480157852; -0.14378681778907776 -0.07980822771787643 … -0.005727448966354132 -0.09460792690515518; … ; -0.02156129479408264 0.1843864619731903 … -0.04695108160376549 0.3686339259147644; 0.04774993658065796 -0.10604676604270935 … -0.0002614356635604054 0.2120383381843567], [0.1391763687133789 0.03398861736059189 … -0.0188425425440073 0.355768084526062; 0.05736823007464409 -0.11152595281600952 … -0.07333791255950928 0.02312125451862812; … ; 0.03470980376005173 -0.1601126790046692 … -0.007050040178000927 -0.562127947807312; -0.17466461658477783 0.014204648323357105 … 0.46678298711776733 0.4063137173652649], [1.0;;], [0.0;;], [0.0; 0.0; 0.0;;], [0.29797041416168213 0.3009076714515686 0.07594253867864609 0.30558115243911743; -0.33255529403686523 -0.4442485272884369 0.42857375741004944 -0.14390836656093597; … ; 0.5437711477279663 0.44203391671180725 -0.25169432163238525 0.4955179989337921; -0.13386361300945282 0.09707959741353989 -0.38008028268814087 0.15276393294334412], [0.13988827168941498 -0.029209962114691734 … -0.2967631220817566 0.5497584342956543], [0.34582117199897766 -0.33130916953086853 0.21589359641075134 -0.19357502460479736; -0.3548073172569275 -0.3922453224658966 -0.37108856439590454 0.20604968070983887; … ; -0.06690354645252228 -0.6899434328079224 0.6516411304473877 -0.23289446532726288; 0.30476993322372437 0.5113816261291504 0.14442609250545502 -0.08943861722946167], [0.5269575715065002 0.09066978842020035 … -0.03968740254640579 0.177832692861557], [0.0 0.0 0.0 0.0], [-0.0, -0.0, 0.0, -0.0, -0.0, 0.0, -0.0, -0.0, -0.0, 0.0], [-0.8271766304969788, 0.13810677826404572, -0.28148776292800903, -0.12242458760738373, -0.4490170180797577, -0.5567880868911743, 0.025562886148691177, -0.026959802955389023, -0.2853533923625946, 0.527955174446106, -0.2083873748779297, 0.020896757021546364, 0.2908017039299011, 0.06982783228158951, 0.6342710852622986, 0.06637370586395264, -0.11119255423545837, -0.11263858526945114, -0.11802570521831512, -0.23057030141353607], [0.15656277537345886], 1.0e-12, [6.395632842977319], true, false, false, true), 1.0, [1.0], false)</code></pre><p>Once the parameters are defined, we can create a REN object in its explicit form.</p><pre><code class="language-julia hljs">ren = REN(lipschitz_ren_ps)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">REN{Float64}(NNlib.relu, 4, 10, 20, 1, ExplicitRENParams{Float64}([-0.013530075647082196 -0.08447739914484435 … -0.13669422708891066 -0.10291401272852563; -0.06259329876993294 0.10298993876353765 … 0.06104743990909783 -0.06895545526812626; … ; 0.013565870729768396 0.140306111007941 … 0.11172587563678857 0.09422294500278613; -0.03509408374331969 0.14841303501266828 … 0.07572837862266808 -0.025023752366458627], [-0.1617530496552856 0.1863359318782896 … 0.2726756221400413 0.011662154385098796; -0.06983220865616449 0.11360841327725614 … -0.35321611235441397 0.19118129227440991; … ; 0.09453504608062258 -0.02841494508454462 … 0.25438193044713 -0.2214246831522081; 0.03998661393235471 -0.2375267453441095 … 0.02398693975570401 0.058012964100629935], [0.26188824902702273 0.1906390292645056 0.2024275217853348 0.24107392220309934; -0.1223453534632878 -0.23546211883329593 0.14746179811130855 -0.03463674831312139; … ; 0.30623632139319057 0.15118739867065792 -0.21577962884384344 0.3543825096918331; -0.13466712276289342 -0.0383457417958423 -0.2677731704763374 0.03715422076881197], [0.020458277087454943 -0.17331254942511387 … 0.08885194913441921 -0.43437686553256405; 0.17306245795479736 0.1236544215903414 … -0.4596335847061486 -0.013933512767059262; … ; -0.03445537723145436 0.19940875378441306 … 0.10892289594474876 0.24026134012574749; -0.03529554919591985 -0.12526604185335674 … 0.15527488657996147 -0.19477906923540608], [0.13988827168941498 -0.029209962114691734 … -0.2967631220817566 0.5497584342956543], [-0.0 -0.0 … -0.0 -0.0; 0.07411589563231619 -0.0 … -0.0 -0.0; … ; -0.43437658445977356 0.00873114843659628 … -0.0 -0.0; 0.19038509036481827 0.5523879111128286 … -0.04300865282430539 -0.0], [0.49129255761708096 -0.470676009568589 0.30671030504199853 -0.2750033156707983; -0.5399206163615482 -0.5968911179962035 -0.5646962637703237 0.3135517933227863; … ; -0.07674324096023266 -0.7914153721355127 0.7474798414312898 -0.2671469155016799; 0.41793692831096263 0.7012675553601659 0.1980543055255232 -0.12264891277782837], [0.5269575715065002 0.09066978842020035 … -0.03968740254640579 0.177832692861557], [-5.000444502909205e-13 -0.0 -0.0 -0.0], [-0.0, -0.0, 0.0, -0.0, -0.0, 0.0, -0.0, -0.0, -0.0, 0.0], [-0.8271766304969788, 0.13810677826404572, -0.28148776292800903, -0.12242458760738373, -0.4490170180797577, -0.5567880868911743, 0.025562886148691177, -0.026959802955389023, -0.2853533923625946, 0.527955174446106, -0.2083873748779297, 0.020896757021546364, 0.2908017039299011, 0.06982783228158951, 0.6342710852622986, 0.06637370586395264, -0.11119255423545837, -0.11263858526945114, -0.11802570521831512, -0.23057030141353607], [0.15656277537345886]))</code></pre><p>Now we can evaluate the REN. We can use the <a href="../../lib/functions/#RobustNeuralNetworks.init_states"><code>init_states</code></a> function to create a batch of initial states, all zeros, of the correct dimensions.</p><pre><code class="language-julia hljs"># Some random inputs
x0 = init_states(ren, batches)
u0 = randn(rng, ren.nu, batches)

# Evaluate the REN over one timestep
x1, y1 = ren(x0, u0)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([-0.011217305668004718 0.21095627583645687 … 0.16450272255323128 0.8922002462715963; 0.19057624039614898 -0.2211223532442873 … -0.013949070033895977 -0.3250782468325051; … ; -0.5195445211656349 0.09444376139104793 … -0.09810399115149575 -0.4156912325824147; -0.8869819188521282 -0.343963000797974 … -0.850637981012911 -1.6660480267543558], [1.0592088843679517 1.1260166302387575 … 0.8912662543023053 1.4445156180304226])</code></pre><p>Having evaluated the REN, we can check that the outputs are the same as in the original example.</p><pre><code class="language-julia hljs"># Print results for testing
println(round.(y1; digits=2))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[1.06 1.13 0.95 0.93 1.03 0.78 0.75 1.42 0.89 1.44]</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« Home</a><a class="docs-footer-nextpage" href="../package_overview/">Package Overview »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Saturday 10 August 2024 04:48">Saturday 10 August 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
